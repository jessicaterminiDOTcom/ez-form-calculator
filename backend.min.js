jQuery(document).ready(function(a){function j(){a(".ezfc-elements-show [data-ot]").each(function(b,c){a(c).opentip(a(c).data("ot"),{fixed:!0,tipJoint:"bottom"})}),a(".ezfc-spinner").spinner()}function l(b){var c="";c+="<li class='button ezfc-form' data-id='"+b.form.id+"' data-action='form_get' data-selectgroup='forms'>",c+="	<i class='fa fa-fw fa-list-alt'></i> ",c+=b.form.id+" - ",c+="	<span class='ezfc-form-name'>"+b.form.name+"</span>",c+="</li>",a(".ezfc-forms-list").append(c),a(".ezfc-form.button-primary").removeClass("button-primary"),a(".ezfc-form[data-id='"+b.form.id+"']").addClass("button-primary"),q(b)}function m(){a(".ezfc-form-element").remove()}function n(b){a(".ezfc-form-elements-actions, .ezfc-form-elements-container, .ezfc-form-options-wrapper").addClass("ezfc-hidden"),a(".ezfc-form[data-id='"+b+"']").remove()}function o(b){a(".ezfc-form-file[data-id='"+b+"']").remove()}function q(b){form_changed=!1;var c="";b&&(a.each(b.elements,function(a,b){c+=t(b)}),a(".ezfc-form-elements").html(c),a(".ezfc-form-elements").sortable({distance:5,forcePlaceholderSize:!0,handle:".ezfc-form-element-name",placeholder:"ui-state-highlight",revert:!0}),a("#ezfc-form-save, #ezfc-form-delete, #ezfc-form-clear").data("id",b.form.id),a("#ezfc-shortcode").text("[ezfc id='"+b.form.id+"' /]"),a("#ezfc-form-name").val(w(b.form.name).replace(/&apos;/g,"'")),u(),r(b.options),a("#ezfc-form-submissions-count").text(b.submissions_count)),a(".ezfc-form-submissions").addClass("ezfc-hidden"),a(".ezfc-form-elements-actions, .ezfc-form-elements-container, .ezfc-form-options-wrapper").removeClass("ezfc-hidden"),a(".ezfc-forms-list").animate({scrollTop:a(".ezfc-forms-list")[0].scrollHeight},"slow"),j(),x()}function r(b){a.each(b,function(b,c){var d="#opt-"+c.o_id;switch(c.type){case"yesno":case"lang":a(d+" option").removeAttr("selected"),a(d+" option[value='"+c.value+"']").attr("selected","selected");break;case"editor":a("#editor_"+c.o_id+"_ifr").contents().find("body").html(y(c.value)),a("#editor_"+c.o_id).val(c.value);break;default:a(d).val(c.value)}})}function s(b){form_changed=!1;var c="<ul>";a.each(b.submissions,function(d,e){var f=new Date(Date.parse(e.date)),g="";1==e.payment_id&&(g+=" <i class='fa fa-fw fa-paypal' data-ot='PayPal used'></i>",g+=e.transaction_id.length>0?" <i class='fa fa-fw fa-check' data-ot='Payment verified.'></i>":" <i class='fa fa-fw fa-times' data-ot='Payment denied or cancelled'></i>"),c+="<li class='ezfc-form-submission' data-id='"+e.id+"'>",c+="	<div class='ezfc-form-submission-name'>",c+="		<i class='fa fa-fw fa-envelope'></i>"+g+" ID: "+e.id+" - "+f.toUTCString(),c+="		<button class='ezfc-form-submission-delete button' data-action='form_submission_delete' data-id='"+e.id+"'><i class='fa fa-times'></i></button>",c+="	</div>",c+="	<div class='ezfc-form-submission-data hidden'>",1==e.payment_id&&(c+="<div>",c+="	<p><strong>Paid with Paypal</strong></p>",c+="	<p>Transaction-ID: "+e.transaction_id,c+="</div>"),c+=e.content,b.files[e.ref_id]&&(c+="	<div class='ezfc-form-files'>",c+="		<p>Files</p>",a.each(b.files[e.ref_id],function(a,b){var d=b.url.split("/").slice(-1);c+="	<ul>",c+="		<li class='ezfc-form-file' data-id='"+b.id+"'>",c+="			<a href='"+b.url+"'>"+d+"</a>",c+="			<button class='ezfc-form-file-delete button' data-action='form_file_delete' data-id='"+b.id+"'><i class='fa fa-times'></i></button>",c+="	</li>",c+="	</ul>"}),c+="	</div>"),c+="</li>"}),c+="</ul>",a(".ezfc-form-submissions").removeClass("ezfc-hidden").html(c),a(".ezfc-form-elements-container, .ezfc-form-options-wrapper").addClass("ezfc-hidden"),a(".ezfc-form-submission-data h2").remove()}function t(f){var g=a.parseJSON(f.data),h=6,i="",j="",k="";k+="<input type='hidden' class='ezfc-form-element-e_id' value='"+f.e_id+"' name='elements["+f.id+"][e_id]' />",a.each(g,function(l,m){if("e_id"!=l&&"preselect"!=l){var n="elements-"+l+"-"+f.id,o="elements["+f.id+"]",p="elements["+f.id+"]["+l+"]",q="";q+="<input type='text' value='"+m+"' name='"+p+"' data-element-name='"+l+"' id='"+n+"' />";var r="";switch(l){case"columns":return h=m,k+="<input name='"+p+"' id='"+n+"' data-element-name='"+l+"' type='hidden' value='"+m+"' />",void 0;case"name":r="Internal name. This value is displayed in submissions/emails only.";break;case"label":r="This text will be displayed in the frontend.",i=m;break;case"description":r="Users will see the description in a tooltip.";break;case"html":q="<textarea name='"+p+"' id='"+n+"'>"+w(m)+"</textarea>";break;case"required":r="Whether this is a required field or not.",j=1==m?"*":"",q="<select class='ezfc-form-element-required-toggle' name='"+p+"' id='"+n+"' data-element-name='"+l+"'>",q+="	<option value='0'>"+ezfc_vars.yes_no.no+"</option>",q+="	<option value='1'"+(1==m?"selected":"")+">"+ezfc_vars.yes_no.yes+"</option>",q+="</select>";break;case"add_line":case"calculate_enabled":case"calculate_before":case"overwrite_price":case"double_check":case"hidden":case"slider":case"spinner":case"use_address":switch(l){case"add_line":r="Add a line above step buttons.";case"calculate_enabled":r="When checked, this field will be taken into calculations.";break;case"calculate_before":r="When checked, this field will be calculated first. <br><br><strong>Checked</strong>: this_field / target_calculation_field. <br><br><strong>Unchecked</strong>: target_calculation_field / this_field.";break;case"overwrite_price":r="When checked, this field will override the calculations above. Useful with division operator. <br><br><strong>Checked</strong>: result = target_calculation_field / this_field. <br><br><strong>Unchecked</strong>: result = current_value + target_calculation_field / this_field.";break;case"double_check":r="Double check email-address";break;case"hidden":r="Pretty self-explanatory, I think. ;)";break;case"slider":r="Display a slider instead of a textfield. Needs minimum and maximum fields defined.";break;case"spinner":r="Display a spinner instead of a textfield.";break;case"use_address":r="Emails will be sent to this address."}q="<select class='ezfc-form-element-"+l+"' name='"+p+"' id='"+n+"' data-element-name='"+l+"'>",q+="	<option value='0'>"+ezfc_vars.yes_no.no+"</option>",q+="	<option value='1'"+(1==m?"selected":"")+">"+ezfc_vars.yes_no.yes+"</option>",q+="</select>";break;case"steps_slider":case"steps_spinner":r="Incremental steps",q="<input class='ezfc-spinner' type='text' value='"+m+"' name='"+p+"' data-element-name='"+l+"' id='"+n+"' />";break;case"factor":r="Field value will be automatically multiplied by this factor. Default factor: 1";break;case"value":r="Predefined value.";break;case"value_external":r="DOM-selector to get the value from (e.g. #myinputfield).";break;case"min":r="Minimum value.";break;case"max":r="Maximum value.";break;case"placeholder":r="Placeholder only (slight background text when no value is present).";break;case"multiple":r="When checked, multiple files can be uploaded.",q="<select class='ezfc-form-element-multiple' name='"+p+"' id='"+n+"' data-element-name='"+l+"'>",q+="	<option value='0'>"+ezfc_vars.yes_no.no+"</option>",q+="	<option value='1'"+(1==m?"selected":"")+">"+ezfc_vars.yes_no.yes+"</option>",q+="</select>";break;case"options":q="<button class='button ezfc-form-element-option-add' data-target='.ezfc-form-element-option' data-element_id='"+f.id+"'>Add option</button></div>",q+="<div class='col-lg-4 col-md-4 col-sm-4 col-xs-4'>Value</div>",q+="<div class='col-lg-6 col-md-6 col-sm-6 col-xs-6'>Text</div>",q+="<div class='col-lg-2 col-md-2 col-sm-2 col-xs-2'>",q+="	<abbr title='Preselect values'>Sel</abbr>&nbsp;",q+="	<abbr title='Remove item'>Rem</abbr>",q+="</div>";var s=0,t=g.preselect?g.preselect:"",u="",v="",x=[];switch(ezfc.elements[f.e_id].name){case"Checkbox":preselect_name="preselect-dummy",v="checkbox",x=a.map(t.split(","),function(a){return parseInt(a)});break;default:preselect_name=o+"[preselect]",v="radio"}a.each(m,function(b,c){q+="<div class='ezfc-form-element-option' data-element_id='"+f.id+"' data-row='"+s+"'>",q+="	<div class='col-lg-4 col-md-4 col-sm-4 col-xs-4'><input class='ezfc-form-element-option-value small' name='"+p+"["+s+"][value]' value='"+c.value+"' type='text' /></div>",q+="	<div class='col-lg-6 col-md-6 col-sm-6 col-xs-6'><input class='ezfc-form-element-option-text' name='"+p+"["+s+"][text]' type='text' value='"+c.text+"' /></div>",u=x.length>0?-1!=a.inArray(s,x)?"checked='checked'":"":g.preselect==s?"checked='checked'":"",q+="	<div class='col-lg-2 col-md-2 col-sm-2 col-xs-2'>",q+="		<input class='ezfc-form-element-option-"+v+"' name='"+o+"[preselect]' type='"+v+"' data-element_id='"+f.id+"' value='"+s+"' "+u+" />&nbsp;",q+="		<button class='button ezfc-form-element-option-delete' data-target='.ezfc-form-element-option' data-element_id='"+f.id+"' data-target_row='"+s+"'><i class='fa fa-times'></i></button>",q+="	</div>",q+="</div>",s++}),"checkbox"==v?q+="<input class='ezfc-form-option-preselect' type='hidden' name='"+o+"[preselect]' data-element_id='"+f.id+"' value='"+t+"' />":"radio"==v&&(u=-1==t?"checked='checked'":"",q+="<div class='col-lg-10 col-md-10 col-sm-10 col-xs-10'>No preselected value</div>",q+="<div class='col-lg-2 col-md-2 col-sm-2 col-xs-2'><input class='ezfc-form-element-option-radio' name='"+o+"[preselect]' type='radio' data-element_id='"+f.id+"' value='-1' "+u+" /></div>"),q+="<div>";break;case"calculate":r="Choose the operator and target element to calculate with. <br><br>Example: [ * ] [ field_1 ]<br>Result = current_value + field_1 * this_field.",q="<button class='button ezfc-form-element-calculate-add' data-target='.ezfc-form-element-calculate-wrapper' data-element_id='"+f.id+"'>Add calculation field</button>&nbsp;",q+="<button class='ezfc-form-calculate-refresh button' data-ot='Refresh fields'><span class='fa fa-refresh'></span></button>",q+="</div>",q+="<div class='col-lg-1 col-md-1 col-sm-1 col-xs-1'><span class='fa fa-question-circle' data-ot='Operator'></span></div>",q+="<div class='col-lg-5 col-md-5 col-sm-5 col-xs-5'>Field</div>",q+="<div class='col-lg-5 col-md-5 col-sm-5 col-xs-5'><span class='fa fa-question-circle' data-ot='Only relevant when no field is selected.'></span> Value</div>",q+="<div class='col-lg-1 col-md-1 col-sm-1 col-xs-1'>Remove</div>",q+="<div class='clearfix'></div>";var s=0;a.each(m,function(c,d){q+="<div class='ezfc-form-element-calculate-wrapper' data-element_id='"+f.id+"' data-row='"+s+"'>",q+="	<div class='col-lg-1 col-md-1 col-sm-1 col-xs-1'>",q+="		<select class='ezfc-form-element-calculate-operator' name='"+p+"["+s+"][operator]' data-element-name='"+l+"'>",a.each(b,function(a,b){var c="";d.operator==b.value&&(c="selected='selected'"),q+="<option value='"+b.value+"' "+c+">"+b.text+"</option>"}),q+="		</select>",q+="	</div>",q+="	<div class='col-lg-5 col-md-5 col-sm-5 col-xs-5'>",q+="		<select class='ezfc-form-element-calculate-target' name='"+p+"["+s+"][target]' id='"+n+"-target' data-element-name='"+l+"' data-calculate_operator='"+d.operator+"' data-calculate_target='"+d.target+"'>",q+="		</select>",q+="	</div>",d.value||(d.value=""),q+="	<div class='col-lg-5 col-md-5 col-sm-5 col-xs-5'>",q+="		<input class='ezfc-form-element-calculate-value' name='"+p+"["+s+"][value]' id='"+n+"-value' data-element-name='"+l+"' value='"+d.value+"' type='text' />",q+="	</div>",q+="	<div class='col-lg-1 col-md-1 col-sm-1 col-xs-1'>",q+="		<button class='button ezfc-form-element-calculate-delete' data-target='.ezfc-form-element-calculate-wrapper' data-element_id='"+f.id+"'><i class='fa fa-times'></i></button>",q+="	</div>",q+="	<div class='clearfix'></div>",q+="</div>",s++}),q+="<div>";break;case"conditional":r="Conditional fields can show or hide elements. Check out the conditional example from the templates or visit the documentation site for more information.",q="<button class='button ezfc-form-element-conditional-add' data-target='.ezfc-form-element-conditional-wrapper' data-element_id='"+f.id+"'>Add conditional field</button>&nbsp;",q+="<button class='ezfc-form-calculate-refresh button' data-ot='Refresh fields'><span class='fa fa-refresh'></span></button>",q+="</div>",q+="<div class='col-lg-2 col-md-2 col-sm-2 col-xs-2'>"+z("Action")+" Action</div>",q+="<div class='col-lg-4 col-md-4 col-sm-4 col-xs-4'>"+z("Target element to show/hide")+" Target element</div>",q+="<div class='col-lg-2 col-md-2 col-sm-2 col-xs-2'>"+z('Conditional operator: when the value of this element equals/is less than/is greater/in between than the conditional value. When using "in between", use a colon (:) as separator.')+" CO</div>",q+="<div class='col-lg-2 col-md-2 col-sm-2 col-xs-2'>"+z("Conditional value")+" Value</div>",q+="<div class='col-lg-1 col-md-1 col-sm-1 col-xs-1'>"+z("Conditional toggle: when this field is checked, the opposite action will not be executed when this condition is triggered")+" CT</div>",q+="<div class='col-lg-1 col-md-1 col-sm-1 col-xs-1'>&nbsp;</div>",q+="<div class='clearfix'></div>";var s=0;a.each(m,function(b,c){q+="<div class='ezfc-form-element-conditional-wrapper' data-element_id='"+f.id+"' data-row='"+s+"'>",q+="	<div class='col-lg-2 col-md-2 col-sm-2 col-xs-2'>",q+="		<select class='ezfc-form-element-conditional-action' name='"+p+"["+s+"][action]' id='"+n+"-action' data-element-name='"+l+"'>",a.each(e,function(a,b){var d="";c.action==b.value&&(d="selected='selected'"),q+="<option value='"+b.value+"' "+d+">"+b.text+"</option>"}),q+="		</select>",q+="	</div>",q+="	<div class='col-lg-4 col-md-4 col-sm-4 col-xs-4'>",q+="		<select class='ezfc-form-element-conditional-target' name='"+p+"["+s+"][target]' data-element-name='"+l+"' data-calculate_target='"+c.target+"' data-show_all='true'>",q+="		</select>",q+="	</div>",q+="	<div class='col-lg-2 col-md-2 col-sm-2 col-xs-2'>",q+="		<select class='ezfc-form-element-conditional-operator' name='"+p+"["+s+"][operator]' id='"+n+"-target' data-element-name='"+l+"'>",a.each(d,function(a,b){var d="";c.operator==b.value&&(d="selected='selected'"),q+="<option value='"+b.value+"' "+d+">"+b.text+"</option>"}),q+="		</select>",q+="	</div>",c.value||(c.value=""),q+="	<div class='col-lg-2 col-md-2 col-sm-2 col-xs-2'>",q+="		<input class='ezfc-form-element-conditional-value' name='"+p+"["+s+"][value]' id='"+n+"-value' data-element-name='"+l+"' value='"+c.value+"' type='text' />",q+="	</div>";var g=c.notoggle&&"1"==c.notoggle?"checked='checked'":"";q+="	<div class='col-lg-1 col-md-1 col-sm-1 col-xs-1'>",q+="		<input class='ezfc-form-element-conditional-notoggle' name='"+p+"["+s+"][notoggle]' id='"+n+"-notoggle' data-element-name='"+l+"' value='1' type='checkbox' "+g+" />",q+="	</div>",q+="	<div class='col-lg-1 col-md-1 col-sm-1 col-xs-1'>",q+="		<button class='button ezfc-form-element-conditional-delete' data-target='.ezfc-form-element-conditional-wrapper' data-element_id='"+f.id+"'><i class='fa fa-times'></i></button>",q+="	</div>",q+="	<div class='clearfix'></div>",q+="</div>",s++}),q+="<div>";break;case"discount":r="Discount values",q="<button class='button ezfc-form-element-discount-add' data-target='.ezfc-form-element-discount-wrapper' data-element_id='"+f.id+"'>Add discount field</button>&nbsp;",q+="</div>",q+="<div class='col-lg-3 col-md-3 col-sm-3 col-xs-3'>Range min</div>",q+="<div class='col-lg-3 col-md-3 col-sm-3 col-xs-3'>Range max</div>",q+="<div class='col-lg-2 col-md-2 col-sm-2 col-xs-2'>Op</div>",q+="<div class='col-lg-3 col-md-3 col-sm-3 col-xs-3'>Discount value</div>",q+="<div class='col-lg-1 col-md-1 col-sm-1 col-xs-1'>Remove</div>",q+="<div class='clearfix'></div>";var s=0;a.each(m,function(b,d){q+="<div class='ezfc-form-element-discount-wrapper' data-element_id='"+f.id+"' data-row='"+s+"'>",q+="	<div class='col-lg-3 col-md-3 col-sm-3 col-xs-3'>",q+="		<input class='ezfc-form-element-discount-range_min' name='"+p+"["+s+"][range_min]' id='"+n+"-value' data-element-name='"+l+"' value='"+d.range_min+"' type='text' />",q+="	</div>",q+="	<div class='col-lg-3 col-md-3 col-sm-3 col-xs-3'>",q+="		<input class='ezfc-form-element-discount-range_max' name='"+p+"["+s+"][range_max]' id='"+n+"-value' data-element-name='"+l+"' value='"+d.range_max+"' type='text' />",q+="	</div>",q+="	<div class='col-lg-2 col-md-2 col-sm-2 col-xs-2'>",q+="		<select class='ezfc-form-element-discount-operator' name='"+p+"["+s+"][operator]' data-element-name='"+l+"'>",a.each(c,function(a,b){var c="";d.operator==b.value&&(c="selected='selected'"),q+="<option value='"+b.value+"' "+c+">"+b.text+"</option>"}),q+="		</select>",q+="	</div>",q+="	<div class='col-lg-3 col-md-3 col-sm-3 col-xs-3'>",q+="		<input class='ezfc-form-element-discount-discount_value' name='"+p+"["+s+"][discount_value]' id='"+n+"-value' data-element-name='"+l+"' value='"+d.discount_value+"' type='text' />",q+="	</div>",q+="	<div class='col-lg-1 col-md-1 col-sm-1 col-xs-1'>",q+="		<button class='button ezfc-form-element-discount-delete' data-target='.ezfc-form-element-discount-wrapper' data-element_id='"+f.id+"'><i class='fa fa-times'></i></button>",q+="	</div>",q+="	<div class='clearfix'></div>",q+="</div>",s++}),q+="<div>";break;case"image":q+="<button class='button ezfc-image-upload'>Choose image</button>",q+="<br><img src='"+m+"' class='ezfc-image-preview' />";break;case"class":r="Additional CSS class for this element.";break;case"GET":r="This field will be filled from a GET-parameter. Example: <br><br><strong>URL</strong>: http://www.test.com/?test_value=1 <br><strong>GET</strong>: test_value <br><strong>Field value</strong>: 1.";break;case"slidersteps":r="Slider step value",q="<input class='ezfc-spinner' name='"+p+"' value='"+m+"' />"}k+="<div class='row'>",k+="	<div class='col-lg-4 col-md-4 col-sm-4 col-xs-4'>",r.length>0&&(k+="		<span class='fa fa-question-circle' data-ot='"+r+"'></span> &nbsp;"),k+="		<label for='"+p+"'>"+l.capitalize()+"</label>",k+="	</div>",k+="	<div class='col-lg-8 col-md-8 col-sm-8 col-xs-8'>",k+=q,k+="	</div>",k+="</div>",k+="<div class='clearfix'></div>"}});var l=i.length>0?" - <span class='element-label'>"+i+"</span>":"",m="";return m+="<li class='ezfc-form-element ezfc-form-element-"+ezfc.elements[f.e_id].type+" ezfc-col-"+h+"' data-columns='"+h+"' data-id='"+f.id+"'>",m+="	<div class='ezfc-form-element-name'>",m+="		<button class='ezfc-form-element-column ezfc-form-element-column-left button'><i class='fa fa-toggle-left'></i></button>",m+="		<button class='ezfc-form-element-column ezfc-form-element-column-right button'><i class='fa fa-toggle-right'></i></button>",m+="		<span class='fa fa-fw "+ezfc.elements[f.e_id].icon+"'></span>",m+="		<span class='ezfc-form-element-required-char'>"+j+"</span> ",m+="		<span class='ezfc-form-element-type'>"+ezfc.elements[f.e_id].name+"</span> "+l,m+="		<button class='ezfc-form-element-delete button' data-action='form_element_delete' data-id='"+f.id+"'><i class='fa fa-times'></i></button>",m+="		</div>",m+="	<div class='container-fluid ezfc-form-element-data ezfc-form-element-"+ezfc.elements[f.e_id].name.replace(" ","-").toLowerCase()+" hidden'>"+k+"</div>",m+="</li>"}function u(){var d=a(".ezfc-form-element-data"),e=d.not(".ezfc-form-element-email, .ezfc-form-element-date, .ezfc-form-element-image, .ezfc-form-element-line, .ezfc-form-element-date, .ezfc-form-element-html, .ezfc-form-element-recaptcha, .ezfc-form-element-file-upload"),f="<option value='0'> </option>";a(d).each(function(b,c){var d=a(c).parents(".ezfc-form-element"),e=a(d).data("id"),g=a(d).find("input[data-element-name='name']").val(),h=a(d).find(".ezfc-form-element-type").text();f+="<option value='"+e+"'>"+g+" ("+h+")</option>"});var g="<option value='0'> </option>";a(e).each(function(b,c){var d=a(c).parents(".ezfc-form-element"),e=a(d).data("id"),f=a(d).find("input[data-element-name='name']").val(),h=a(d).find(".ezfc-form-element-type").text();g+="<option value='"+e+"'>"+f+" ("+h+")</option>"}),a(".ezfc-form-element-calculate-target, .ezfc-form-element-conditional-target").each(function(b,c){var e=a(this).data("calculate_operator"),h=a(this).find(":selected").val()||a(this).data("calculate_target"),i=a(this).data("show_all")?!0:!1,j=i?f:g;a(c).html(j);var k=a(c).parent();k.parent().find(".ezfc-form-element-calculate-operator option[value='"+e+"']").prop("selected","selected"),k.parent().find(".ezfc-form-element-calculate-target option[value='"+h+"']").prop("selected","selected"),i&&(k.find(".ezfc-form-element-conditional-action option[value='"+h+"']").prop("selected","selected"),k.find(".ezfc-form-element-conditional-target option[value='"+h+"']").prop("selected","selected"))})}function v(b){a(".spinner").fadeIn("fast");var c=a(b).data("action"),d=a(".ezfc-forms-list .button-primary").data("id"),e=a(b).data("id"),f="action="+c;switch(c){case"form_add":case"form_template_delete":e=a("#ezfc-form-template-id option:selected").val();break;case"form_duplicate":case"form_preview":case"form_get_submissions":e=a(".ezfc-forms-list .button-primary").data("id");break;case"form_element_add":if(!d)return!1;var g=e;f+="&e_id="+g+"&f_id="+d;break;case"form_clear":case"form_element_delete":case"form_delete":case"form_submission_delete":case"form_template_delete":case"form_file_delete":if("form_template_delete"==c&&0==e)return a(".spinner").hide(),!1;if(!confirm(ezfc_vars.delete_element))return a(".spinner").hide(),!1;break;case"form_show":return a(".spinner").hide(),q(null),!1;case"form_show_import":return a(".spinner").hide(),a(".ezfc-import-dialog").dialog("open"),a("#form-import-data").val(""),!1;case"form_import_data":e=d,f+="&import_data="+encodeURIComponent(a("#form-import-data").val().replace(/'/g,"&apos;"));break;case"form_show_export":e=d;break;case"form_save":case"form_preview":tinyMCE.triggerSave(),a(".ezfc-form-element-checkbox").each(function(){var b=[];a(this).find(".ezfc-form-element-option-checkbox").each(function(c,d){a(d).is(":checked")&&b.push(a(d).val())}),a(this).find(".ezfc-form-option-preselect").val(b.join(","))});var h=encodeURIComponent(JSON.stringify(a("#form-elements").serializeArray()).replace(/'/g,"&apos;")),i=encodeURIComponent(JSON.stringify(a("#form-options").serializeArray()).replace(/'/g,"&apos;")),k=encodeURIComponent(a("#ezfc-form-name").val());f+="&elements="+h+"&options="+i+"&ezfc-form-name="+k;break;case"form_save_template":e=d;break;case"form_show_options":return a(".spinner").hide(),a(".ezfc-options-dialog").dialog("open"),!1;case"form_update_options":tinyMCE.triggerSave();var p=a("#form-options").serialize();f+="&"+p,e=d}return e&&(f+="&id="+e),f+="&nonce="+ezfc_nonce,a.ajax({type:"post",url:ajaxurl,data:{action:"ezfc_backend",data:f},success:function(d){if(a(".spinner").fadeOut("fast"),response_json=a.parseJSON(d),!response_json)return a(".ezfc-error").text("Something went wrong. :("),!1;if(response_json.error)return a(".ezfc-error").text(response_json.error),!1;switch(a(".ezfc-error").text(""),response_json.message&&a(".ezfc-message").text(response_json.message),c){case"element_get":element_show(response_json.element[0]);break;case"form_add":case"form_duplicate":l(response_json);break;case"form_get":q(response_json);break;case"form_get_submissions":s(response_json);break;case"form_clear":m();break;case"form_delete":n(e);break;case"form_file_delete":o(e);break;case"form_save":form_changed=!1,a(".ezfc-form[data-id='"+e+"'] .ezfc-form-name").text(a("#ezfc-form-name").val());break;case"form_save_template":var f=a("#ezfc-form-name").val();a("#ezfc-form-template-id").append("<option value='"+response_json+"'>"+f+"</option>");break;case"form_template_delete":a("#ezfc-form-template-id option[value='"+e+"']").remove();break;case"form_element_delete":a(b).parents(".ezfc-form-element").remove(),u();break;case"form_element_add":a(".ezfc-form-elements").append(t(response_json)),u(),j();break;case"form_submission_delete":a(b).parents(".ezfc-form-submission").remove();break;case"form_update_options":a(".ezfc-forms-list li[data-id='"+e+"'] .ezfc-form-name").text(a("#opt-name").val()),a(".ezfc-dialog").dialog("close");break;case"form_import_data":l(response_json),q(response_json),a(".ezfc-dialog").dialog("close");break;case"form_show_export":a("#form-export-data").val(JSON.stringify(response_json)),a(".ezfc-export-dialog").dialog("open")}}}),!1}function w(a){return(a+"").replace(/\\(.?)/g,function(a,b){switch(b){case"\\":return"\\";case"0":return"\0";case"":return"";default:return b}})}function x(b,c){var d=a(b).parents(".ezfc-form-element"),e=d.data("columns"),f=Math.min(6,Math.max(1,e+c));d.removeClass("ezfc-col-"+e).addClass("ezfc-col-"+f).data("columns",f).find("[data-element-name='columns']").val(f)}function y(a,b){var c=b||"undefined"==typeof b?"<br />":"<br>";return(a+"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1"+c+"$2")}function z(a){return"<span class='fa fa-question-circle' data-ot='"+a+"'></span>"}function A(b){a(b).find("input").val(""),a(b).find("select").val("0")}ezfc_z_index=10,form_changed=!1;var b=[{value:"0",text:" "},{value:"add",text:"+"},{value:"subtract",text:"-"},{value:"multiply",text:"*"},{value:"divide",text:"/"},{value:"equals",text:"="},{value:"power",text:"^"}],c=[{value:"0",text:" "},{value:"add",text:"+"},{value:"subtract",text:"-"},{value:"percent_add",text:"%+"},{value:"percent_sub",text:"%-"},{value:"equals",text:"="}],d=[{value:"0",text:" "},{value:"gr",text:">"},{value:"gre",text:">="},{value:"less",text:"<"},{value:"lesse",text:"<="},{value:"equals",text:"="},{value:"between",text:"between"}],e=[{value:"0",text:" "},{value:"show",text:"Show"},{value:"hide",text:"Hide"}];a("#tabs").tabs();var f={autoOpen:!1,height:Math.min(800,a(window).height()-200),width:Math.min(1200,a(window).width()-200),modal:!0},g={buttons:{"Update options":function(){a(".ezfc-option-save").click()},Cancel:function(){a(this).dialog("close")}}},h={buttons:{"Import data":function(){a("[data-action='form_import_data']").click()},Cancel:function(){a(this).dialog("close")}}},i={buttons:{Close:function(){a(this).dialog("close")}}};a(".ezfc-options-dialog").dialog(a.extend(f,g)),a(".ezfc-import-dialog").dialog(a.extend(f,h)),a(".ezfc-export-dialog").dialog(a.extend(f,i)),a("body").on("click","[data-action]",function(){if("form_get"==a(this).data("action")&&form_changed&&!confirm(ezfc_vars.form_changed))return a(".spinner").hide(),!1;v(a(this));var b=a(this).data("selectgroup");return b&&(a(".button-primary[data-selectgroup='"+b+"']").removeClass("button-primary"),a(this).addClass("button-primary")),!1}),a("body").on("click",".ezfc-form-element-name",function(){a(this).parent().find(".ezfc-form-element-data").toggle().css("z-index",++ezfc_z_index)}),a("body").on("click",".ezfc-form-submission-name",function(){a(this).parent().find(".ezfc-form-submission-data").toggle()});var k;a("body").on("click",".ezfc-image-upload",function(b){b.preventDefault();var c=this;return k?(k.open(),void 0):(k=wp.media.frames.file_frame=wp.media({title:jQuery(this).data("uploader_title"),button:{text:jQuery(this).data("uploader_button_text")},multiple:!1}),k.on("select",function(){var b=k.state().get("selection").first().toJSON();a(c).parents(".ezfc-form-element-data").find("[data-element-name='image']").val(b.url),a(c).parents(".ezfc-form-element-data").find(".ezfc-image-preview").attr("src",b.url)}),k.open(),void 0)}),a(".ezfc-toggle-show").on("click",function(){a(".ezfc-form-element-data, .ezfc-form-submission-data").show()}),a(".ezfc-toggle-hide").on("click",function(){a(".ezfc-form-element-data, .ezfc-form-submission-data").hide()}),a(".ezfc-toggle-expand").on("click",function(){a(".ezfc-form-elements-container").toggleClass("full-width")}),a("body").on("click",".ezfc-form-element-option-add",function(){form_changed=!0;var b=a(this).data("element_id"),c=a(a(this).data("target")+"[data-element_id='"+b+"']:last"),d=a(c).data("row"),e=parseInt(d)+1;return a(c).clone().attr("data-row",e).find(".ezfc-form-element-option-value").attr("name","elements["+b+"][options]["+e+"][value]").end().find(".ezfc-form-element-option-text").attr("name","elements["+b+"][options]["+e+"][text]").end().insertAfter(c),!1}),a("body").on("click",".ezfc-form-element-option-delete",function(){var b=a(this).parents(a(this).data("target")),c=a(this).data("element_id"),d=a(a(this).data("target")+"[data-element_id='"+c+"']").length;return 1>=d?!1:(a(b).remove(),!1)}),a("body").on("click",".ezfc-form-element-calculate-add",function(){form_changed=!0;var b=a(this).data("element_id"),c=a(a(this).data("target")+"[data-element_id='"+b+"']:last"),d=a(c).data("row"),e=parseInt(d)+1;return a(c).clone().attr("data-row",e).find(".ezfc-form-element-calculate-operator").attr("name","elements["+b+"][calculate]["+e+"][operator]").end().find(".ezfc-form-element-calculate-target").attr("name","elements["+b+"][calculate]["+e+"][target]").end().find(".ezfc-form-element-calculate-value").attr("name","elements["+b+"][calculate]["+e+"][value]").end().insertAfter(c),!1}),a("body").on("click",".ezfc-form-element-calculate-delete",function(){var b=a(this).parents(a(this).data("target")),c=a(this).data("element_id"),d=a(a(this).data("target")+"[data-element_id='"+c+"']").length;return 1>=d?(A(b),!1):(a(b).remove(),!1)}),a("body").on("click",".ezfc-form-element-conditional-add",function(){form_changed=!0;var b=a(this).data("element_id"),c=a(a(this).data("target")+"[data-element_id='"+b+"']:last"),d=a(c).data("row"),e=parseInt(d)+1;return a(c).clone().attr("data-row",e).find(".ezfc-form-element-conditional-action").attr("name","elements["+b+"][conditional]["+e+"][action]").end().find(".ezfc-form-element-conditional-target").attr("name","elements["+b+"][conditional]["+e+"][target]").end().find(".ezfc-form-element-conditional-operator").attr("name","elements["+b+"][conditional]["+e+"][operator]").end().find(".ezfc-form-element-conditional-value").attr("name","elements["+b+"][conditional]["+e+"][value]").end().insertAfter(c),!1}),a("body").on("click",".ezfc-form-element-conditional-delete",function(){var b=a(this).parents(a(this).data("target")),c=a(this).data("element_id"),d=a(a(this).data("target")+"[data-element_id='"+c+"']").length;return 1>=d?(A(b),!1):(a(b).remove(),!1)}),a("body").on("click",".ezfc-form-element-discount-add",function(){form_changed=!0;var b=a(this).data("element_id"),c=a(a(this).data("target")+"[data-element_id='"+b+"']:last"),d=a(c).data("row"),e=parseInt(d)+1;return a(c).clone().attr("data-row",e).find(".ezfc-form-element-discount-range_min").attr("name","elements["+b+"][discount]["+e+"][range_min]").end().find(".ezfc-form-element-discount-range_max").attr("name","elements["+b+"][discount]["+e+"][range_max]").end().find(".ezfc-form-element-discount-operator").attr("name","elements["+b+"][discount]["+e+"][operator]").end().find(".ezfc-form-element-discount-discount_value").attr("name","elements["+b+"][discount]["+e+"][discount_value]").end().insertAfter(c),!1}),a("body").on("click",".ezfc-form-element-discount-delete",function(){var b=a(this).parents(a(this).data("target")),c=a(this).data("element_id"),d=a(a(this).data("target")+"[data-element_id='"+c+"']").length;return 1>=d?(A(b),!1):(a(b).remove(),!1)}),a("body").on("click",".ezfc-form-calculate-refresh",function(){return u(),!1}),a("body").on("keyup",".ezfc-form-element-data input[data-element-name='label']",function(){form_changed=!0;var b=a(this).val();a(this).parents(".ezfc-form-element").find(".element-label").text(b)}),a("body").on("click",".ezfc-form-element-required-toggle",function(){form_changed=!0;var b=1==a(this).val()?"*":"";a(this).parents(".ezfc-form-element").find(".ezfc-form-element-required-char").text(b)}),a("body").on("click","form .ezfc-element-submit",function(){return!1}),a("body").on("click",".ezfc-form-element-column-left",function(){return x(a(this),-1),!1}),a("body").on("click",".ezfc-form-element-column-right",function(){return x(a(this),1),!1}),String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)}});