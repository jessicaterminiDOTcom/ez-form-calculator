jQuery(document).ready(function(a){function d(c){var d=0;return a(c).find(".ezfc-custom-element").each(function(f,g){var h=a(c).data("id"),i=a(g),j=a(g).data("element");if(!a(this).hasClass("ezfc-hidden")||"subtotal"==j||"hidden"==j){var k=i.data("value_external");if(k&&a(k).length>0){var l=a(k).val();"input"==j||"numbers"==j||"subtotal"==j?i.find("input").val(l):"dropdown"==j?(i.find(":selected").removeAttr("selected"),i.find("option[value='"+l+"']").attr("selected","selected")):"radio"==j?(i.find(":checked").removeAttr("checked"),i.find("input[value='"+l+"']").attr("checked","checked")):"checkbox"==j&&(i.find(":checked").removeAttr("checked"),i.find("input[value='"+l+"']").attr("checked","checked")),b[h][k]||(b[h][k]=1,a(k).on("change keyup",function(){e(a(c))}))}var m=i.data("conditional_action"),n=i.data("conditional_operator"),o=i.data("conditional_target"),p=i.data("conditional_values"),q=i.data("conditional_notoggle");if(m&&0!=m){var r=m.toString().split(","),s=n.toString().split(","),t=o.toString().split(","),u=p.toString().split(","),v=q.toString().split(","),w=parseFloat(i.val());"input"==j||"numbers"==j||"subtotal"==j?w=parseFloat(i.find("input").val()):"dropdown"==j?w=parseFloat(i.find(":selected").data("value")):"radio"==j?w=parseFloat(i.find(":checked").data("value")):"checkbox"==j&&(w=0,i.find(":checked").each(function(b,c){w+=parseFloat(a(c).data("value"))})),a.each(r,function(b,c){var d=a("#ezfc_element-"+t[b]);if(!(d.length<1)){var e;e="input"==j?u[b]:parseFloat(u[b]);var f;if("input"==j)f=e.toLowerCase()==e.toLowerCase();else switch(s[b]){case"gr":f=w>e;break;case"gre":f=w>=e;break;case"less":f=e>w;break;case"lesse":f=e>=w;break;case"equals":f=w==e;break;case"between":var g=u[b].split(":");f=g.length<2?!1:w>=g[0]&&w<=g[1];break;default:f=!1}var h,i;"show"==c?(h="removeClass",i="addClass"):(h="addClass",i="removeClass");var k=v[b];f?d[h]("ezfc-hidden ezfc-custom-hidden"):1!=k&&d[i]("ezfc-hidden ezfc-custom-hidden")}})}var x=i.data("calculate_enabled")||"",y=i.data("calculate_operator")||"",z=i.data("calculate_target")||"",A=i.data("calculate_values")||"",B=i.data("overwrite_price")||"",C=a(i).find(".ezfc-element-numbers, .ezfc-element-input-hidden, .ezfc-element-subtotal, :selected, :checked");a(C).each(function(b,c){var e=parseFloat(a(c).data("factor")),f=parseFloat(a(c).val());if(x&&"0"!=x||z&&"0"!=z||A&&"0"!=A||"subtotal"==j||"hidden"==j){(!f||isNaN(f))&&(f=0),e&&!isNaN(e)||0===e||(e=1);var h=f;switch(a(g).data("element")){case"numbers":case"hidden":h=f*e;break;case"dropdown":case"radio":case"checkbox":h=parseFloat(a(c).data("value")),isNaN(h)&&(h=0);break;case"subtotal":h=d}var i=y.toString().split(",");calc_target_elements=z.toString().split(","),calc_custom_values=A.toString().split(","),i.length>0&&0!=i[0]&&a.each(i,function(b,d){var e=a("#ezfc_element-"+calc_target_elements[b]),i=calc_custom_values[b];if(e.length<1&&(!i||"0"==i))return!1;var j;if(e.length>0){var k=e.data("element");if("numbers"==k||"subtotal"==k){var l=e.find("input"),m=parseFloat(l.data("factor"));(!m||isNaN(m))&&(m=1),j=parseFloat(l.val())*m}else"dropdown"==k?j=parseFloat(e.find(":selected").data("value")):"radio"==k?j=parseFloat(e.find(":checked").data("value")):"checkbox"==k&&(j=0,e.find(":checked").each(function(b,c){j+=parseFloat(a(c).data("value"))}))}else"0"!=i&&(j=i);switch((!j||isNaN(j))&&(j=0),d){case"add":h+=j;break;case"subtract":h-=j;break;case"multiply":h*=j;break;case"divide":if(0==j)return;h/=j,"1"==a(c).data("calculate_before")&&(B=1,h=j/f);break;case"equals":h=j,a(g).val(h);break;case"power":h=Math.pow(h,j)}}),"1"==B?d=h:"1"==x&&(d+=h),"subtotal"==j&&a(g).find("input").val(d)}});var D=i.data("discount_range_min"),E=i.data("discount_range_max"),F=i.data("discount_operator"),G=i.data("discount_values");if(G){var H=D.toString().split(","),I=E.toString().split(","),J=F.toString().split(","),K=G.toString().split(","),w=0;if("input"==j||"numbers"==j||"subtotal"==j||"hidden"==j){var L=i.find("input"),M=parseFloat(L.data("factor"));M&&!isNaN(M)||0===M||(M=1),w=parseFloat(L.val())*M}else"dropdown"==j?w=parseFloat(i.find(":selected").data("value")):"radio"==j?w=parseFloat(i.find(":checked").data("value")):"checkbox"==j&&(w=0,i.find(":checked").each(function(b,c){w+=parseFloat(a(c).data("value"))}));a.each(J,function(a,b){if(H[a]||0===H[a]||(H[a]=Number.NEGATIVE_INFINITY),I[a]||0===I[a]||(I[a]=Number.POSITIVE_INFINITY),w>=parseFloat(H[a])&&w<=parseFloat(I[a])){var c=parseFloat(K[a]);switch(b){case"add":d+=c;break;case"subtract":d-=c;break;case"percent_add":d+=w*(c/100);break;case"percent_sub":d-=w*(c/100);break;case"equals":d=c}}})}}}),d}function e(b){var c=a(b).data("currency"),e=a(b).data("id"),g=d(a(b)),h=f(e,g,c);a(b).find(".ezfc-price").text(h)}function f(a,b,d){var b=numeral(b).format(c);return b=0==ezfc_form_vars[a].currency_position?d+" "+b:b+" "+d}function g(){a(".ezfc-fixed-price").each(function(){var b=a(this).offset(),c=a(this).data("id"),d=a(".ezfc-form[data-id='"+c+"']"),e=d.outerHeight(),f=d.offset(),g=a(window).scrollTop(),h=f.top-g;0>h&&h>-e&&a(this).offset({top:g}),h>0&&b.top>f.top&&a(this).offset({top:f.top})})}function h(b){a(b).find(".ezfc-custom-hidden").each(function(){a.each(a(this).find("input, :selected"),function(){a(this).val(a(this).data("initvalue")).removeAttr("disabled")})})}function i(b,c){var d=parseInt(b.find(".ezfc-step-active").data("step")),e=b.find("[data-step='"+d+"']");return e.fadeOut(200,function(){b.find("[data-step='"+c+"']").fadeIn(200).addClass("ezfc-step-active"),a(this).removeClass("ezfc-step-active")}),!1}var b=[],c=ezfc_vars.price_format?ezfc_vars.price_format:"0,0[.]00";numeral.defaultFormat(c),a.datepicker.setDefaults(a.datepicker.regional[ezfc_vars.datepicker_language]),a(".ezfc-form").each(function(){var c=a(this).data("id");b[c]=[],a(this).find(".ezfc-element-datepicker").datepicker({dateFormat:ezfc_form_vars[c].datepicker_format}),a(this).find(".ezfc-element-timepicker").timepicker({timeFormat:ezfc_form_vars[c].timepicker_format});var d=a(this).find(".ezfc-step");if(d.length>0){var f=d.last();a(this).find(".ezfc-submit-wrapper").appendTo(f).addClass("ezfc-submit-step")}e(a(this)),e(a(this))}),a(".ezfc-element-fileupload").each(function(b,c){var d=a(this).parents(".ezfc-element"),e=a(d).find(".ezfc-upload-button");a(this).fileupload({dataType:"json",add:function(b,f){a(d).find(".ezfc-bar").css("width",0),a(d).find(".progress").addClass("active"),a(d).find(".ezfc-fileupload-message").text(""),e.click(function(){return""==a(c).val()?!1:(f.submit(),a(e).attr("disabled","disabled"),b.preventDefault(),!1)})},done:function(b,c){return c.result.error?(a(e).removeAttr("disabled"),a(d).find(".ezfc-fileupload-message").text(c.result.error),a(d).find(".ezfc-bar").css("width",0),!1):(a(this).attr("multiple")&&(a(this).val(""),a(e).removeAttr("disabled")),a(d).find(".progress").removeClass("active"),a(d).find(".ezfc-fileupload-message").text(ezfc_vars.upload_success),void 0)},progressall:function(b,c){var e=parseInt(100*(c.loaded/c.total),10);a(d).find(".ezfc-bar").css("width",e+"%")},replaceFileInput:!1,url:ezfc_ajaxurl_fileupload})}),a(".ezfc-overview").dialog({autoOpen:!1,modal:!0}),a(".ezfc-form input, .ezfc-form select").on("change keyup",function(){e(a(this).parents(".ezfc-form"))}),a(".ezfc-slider").each(function(b,c){var d=a(this);a(c).parents(".ezfc-element").find(".ezfc-slider-element").slider({min:d.data("min")||0,max:d.data("max")||100,step:d.data("stepsslider")||1,value:d.val()||0,slide:function(a,b){d.val(b.value)},stop:function(){d.trigger("change")}})}),a(".ezfc-spinner").each(function(){var d=a(this);d.spinner({min:d.data("min")||null,max:d.data("max")||null,step:d.data("stepsspinner"),change:function(){d.trigger("change")},spin:function(){d.trigger("change")}})}),a(".ezfc-step-button").on("click",function(){var b=a(this).parents(".ezfc-form"),c=parseInt(b.find(".ezfc-step-active").data("step")),d=c+(a(this).hasClass("ezfc-step-next")?1:-1);return i(b,d),!1}),a(window).scroll(function(){g()}),g(),a(".ezfc-form").submit(function(b){var c=a(this);a(".ezfc-loading").show();var d=a(c).find(".ezfc-submit-icon");d.fadeIn();var e=a(c).find("input[type='submit']");e.attr("disabled","disabled"),a(this).find(".ezfc-custom-hidden").each(function(){a(this).find("input").val("__HIDDEN__"),a(this).find(":selected").val("__HIDDEN__");var b=a(this).find(".ezfc-element-radio:not(:has(:radio:checked))");b.length&&a(b).first().find("input").prop("checked",!0)});var f=a(this).data("id"),g="id="+f+"&"+a(this).serialize();return a.ajax({type:"post",url:ezfc_ajaxurl,data:{action:"ezfc_frontend",data:g},success:function(b){if(a(".ezfc-loading").hide(),e.removeAttr("disabled"),d.fadeOut(),"1"==ezfc_vars.debug_mode&&console.log(b),b=a.parseJSON(b),!b)return a(c).find(".ezfc-message").text("Something went wrong. :("),"undefined"!=typeof Recaptcha&&Recaptcha.reload(),h(c),!1;if(b.error){if(h(c),b.id){var g="#ezfc_element-"+b.id,j=a(g).find(".ezfc-element").first(),k=a(c).find(".ezfc-step-active").length>0?!0:!1;if(k){var l=parseInt(a(g).parents(".ezfc-step").data("step"));i(c,l)}j.length>0?a(j).opentip(b.error,{delay:800,hideDelay:.1,hideTriggers:["closeButton","target"],removeElementsOnHide:!0,showOn:null,target:g+" label",targetJoint:"top left",tipJoint:"bottom"}).show():alarm(b.error)}else{var n=a(c).parents(".ezfc-wrapper").find(".ezfc-message");n.text(b.error).fadeIn(),setTimeout(function(){n.fadeOut()},7500)}return"undefined"!=typeof Recaptcha&&Recaptcha.reload(),!1}"undefined"!=typeof Recaptcha&&Recaptcha.reload(),b.paypal?(e.attr("disabled","disabled"),window.location=b.paypal):(ezfc_form_vars[f]&&ezfc_form_vars[f].hide_all_forms&&1==ezfc_form_vars[f].hide_all_forms?a(".ezfc-form, .ezfc-required-notification").fadeOut():a(".ezfc-form[data-id='"+f+"'], .ezfc-required-notification").fadeOut(),a(".ezfc-success-text[data-id='"+f+"']").fadeIn(),ezfc_form_vars[f]&&ezfc_form_vars[f].redirect_url&&ezfc_form_vars[f].redirect_url.length>0&&window.location.replace(ezfc_form_vars[f].redirect_url))}}),b.preventDefault(),!1})});